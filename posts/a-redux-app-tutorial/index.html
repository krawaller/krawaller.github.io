<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="/static/styles/nprogress.css"/><link rel="stylesheet" href="/static/styles/code.css"/><link rel="stylesheet" href="/static/styles/site.css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Lexend+Zetta&amp;display=swap" rel="stylesheet"/><script async="" src="https://www.google-analytics.com/analytics.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-11433118-1', 'auto');
  ga("send", "pageview");</script><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta charSet="utf-8"/><title>A Redux app tutorial</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/posts/a-redux-app-tutorial.js" as="script"/><link rel="preload" href="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-3df6523e264ff2ac6548.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.ebbfd942159f83091516.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-c1620565ee9f1f33603c.js" as="script"/></head><body><div id="__next"><div style="margin-bottom:20px"></div><div class="master"><h1><a href="/"><span>k</span><span>r</span><span>a</span><span>w</span><span>a</span><span>l</span><span>l</span><span>e</span><span>r</span></a></h1><hr/><div class="summary">Grokking Redux thinking by walking through a minimal app example</div><hr/><h2>A Redux app tutorial</h2><p class="taglist">Tags:<!-- --> <a href="/tags/redux/">redux</a><a href="/tags/case_study/">case study</a></p><div class="page-content"><div class="post" data-postid="reduxexamplewalkthrough"><h3 id="the-premise">The premise</h3><p>We recently published a post that <a href="/posts/exploring-redux-middleware/">explored Redux middleware</a>, based on Dan Abramov&#x27;s <a href="https://twitter.com/dan_abramov/status/664135757297295360">minimal Redux example</a>. During the conversations following that post it became evident that however minimal the example is, there&#x27;s room for an explanation of the how and why behind it. Which is exactly what this post provides - a <strong>walkthrough of a basic Redux example</strong>!</p><p>We&#x27;ll be picking apart a super simple Redux app, only slightly bigger in scope than Dan&#x27;s example. Like in his example there&#x27;ll be no external dependencies - this will be a pure Redux experience.</p><h3 id="our-map">Our map</h3><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map.png" alt="Map"/></p><p>This is the journey we&#x27;ll make throughout this post. It might look complicated, but don&#x27;t fret - this isn&#x27;t a map of the code but of <strong>everything</strong>, that is, the involved <em>ideas</em> and <em>concepts</em> as well as the code.</p><p>From here on, <strong>each headline will correspond to a concept bubble</strong> in the above map. For each concept we&#x27;ll repeat a slice of the map showing the concepts that the current concept builds on, and what concepts it in turn is building up to.</p><h3 id="app-idea">App idea</h3><p>Before we can do anything, we need to have an <strong>app idea</strong> so we know what we&#x27;re going to create! This will allow us to figure out a <strong>UI</strong>, the <strong>action shapes</strong> and <strong>state shape</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-appidea.png" alt="Map"/></p><p>Let&#x27;s make a simple <strong>counter</strong> app. The counter increases whenever the user clicks a <strong>button</strong>, by an amount controlled by an <strong>input</strong>. It should look something like this:</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-screen.png" alt="Map"/></p><p>Essentially the same app that Dan built in his minimal example, except here we can increase by any amount and not just 1.</p><h3 id="state-shape">State shape</h3><p>Now that we have an <strong>app idea</strong>, let&#x27;s decide on the <strong>state shape</strong>. That will in turn let us figure out what our <strong>initial state</strong> should be, as well as define our <strong>reducer</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-stateshape.png" alt="State shape"/></p><p>In Redux, all the app state is contained in one single <strong>object</strong>.</p><p>However, in our simple counter app, we only need to track one single thing - the current count. Thus our state can be a <strong>single number</strong>.</p><h3 id="initial-state">Initial state</h3><p>Having decided on a <strong>state shape</strong>, however simple, we can now define an <strong>initial state</strong>. We&#x27;ll need this to code our <strong>store</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-initialstate.png" alt="Initial state"/></p><p>For our little app that only entails one single decision - at what number should we start the count? Let&#x27;s go with 0!</p><p>This also lets us write our first line of code:</p><pre><code class="hljs"><span class="hljs-attribute">var initialstate</span> = 0;</code></pre><h3 id="action-shapes">Action shapes</h3><p>Let&#x27;s design the <strong>actions</strong> needed for our <strong>app idea</strong>! We need them in order to make <strong>action creators</strong> and code the <strong>reducer</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-actions.png" alt="Action shapes"/></p><p>In our app only one single thing can happen - <strong>incrementing</strong> the counter. Let&#x27;s decide that the <strong>action</strong> describing this event looks like this:</p><pre><code class="hljs language-json">{<br/>  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;INCREMENT&quot;</span>,<br/>  <span class="hljs-attr">&quot;by&quot;</span>: <span class="hljs-number">3</span><br/>}</code></pre><p>In Redux all actions are described by <strong>objects</strong> with a mandatory <code>type</code> property, and eventual further data payload props. In our case just <code>by</code>.</p><div class="smallnote">Note: Normally we would isolate all string constants such as <code>&quot;INCREMENT&quot;</code> to a separate file, but in this simple example we&#x27;ll live with having a single magic string like this.</div><h3 id="reducer">Reducer</h3><p>Now that we have designed the <strong>action shapes</strong> and the <strong>state shape</strong> we can move on to define our <strong>reducer</strong>! With the reducer we&#x27;ll be able to instantiate a <strong>store</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-reducer.png" alt="Reducer"/></p><p>Remember: a <strong>reducer</strong> in Redux lingo is simply a function that takes the current state and an action, and returns a new state:</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-reducer.png" alt="Reducer"/></p><p>The reducer in our app just needs to deal with a single action, namely <code>INCREMENT</code>:</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> reducer = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">state, action</span>) </span>{<br/>  <span class="hljs-keyword">switch</span> (action.type) {<br/>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;INCREMENT&quot;</span>:<br/>      <span class="hljs-keyword">return</span> state + action.by;<br/>    <span class="hljs-keyword">default</span>:<br/>      <span class="hljs-keyword">return</span> state;<br/>  }<br/>};</code></pre><p>When the <code>INCREMENT</code> action happens we create a new state by adding <code>action.by</code> to the current state.</p><div class="smallnote">Remember that we must <strong>always</strong> have a default case returning the current state, to deal with internal Redux startup actions.</div><div class="smallnote">Since our reducer deals with just a single action it would be better phrased as an <code>if-else</code>. We only used a <code>switch</code> because that&#x27;s what a reducer normally looks like.</div><div class="smallnote">For more complex app we would write subreducers that each worked on parts of the state, and then combine them into one single reducer.</div><h3 id="store">Store</h3><p>With the <strong>initial state</strong> and <strong>reducer</strong> in place, we can now create a <strong>store</strong> for our app state! That will let us code <strong>interaction</strong> for our <strong>app</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-store.png" alt="Store"/></p><p>A store is instantiated using <code>Redux.createStore</code>:</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> store = Redux.createStore(reducer, initialstate);</code></pre><div class="smallnote">We can also pass in an <strong>enhancer</strong> to <code>createStore</code>, commonly <strong>middlewares</strong>, but we don&#x27;t need that here.</div><div class="smallnote">An alternative to providing an <code>initialstate</code> on store creation is to have a default return value inside the reducer.</div><h3 id="action-creators">Action creators</h3><p>Knowing the shape of the <strong>actions</strong> lets us define <strong>action creators</strong> to be consumed by our views to create <strong>interaction</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-actioncreators.png" alt="action creators"/></p><p>Only one single action creator is needed in our app.</p><pre><code class="hljs"><span class="hljs-keyword">var</span> actionCreators = {<br/>    increment: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-keyword">int</span></span>)</span>{<br/>        <span class="hljs-keyword">return</span> {type: <span class="hljs-string">&#x27;INCREMENT&#x27;</span>, by: <span class="hljs-keyword">int</span>};<br/>    }<br/>};</code></pre><p>Note how the action creator returns an action as previously defined.</p><div class="smallnote">Action creators are sometimes called &quot;actions&quot;, which can cause some confusion as to the difference to actual action objects.</div><div class="smallnote">Action creators aren&#x27;t strictly needed. Their main point is to provide a place to harbour eventual dispatch logic and save us from having to give our views access to the store.</div><div class="smallnote">In order to sanely define asynchronous actions we can use <a href="https://github.com/gaearon/redux-thunk">Redux-thunk</a>, a middleware which lets us return functions instead of actions from our action creators. We touch on this at the end of our <a href="/posts/exploring-redux-middleware/">middleware post</a>.</div><h3 id="ui">UI</h3><p>Let&#x27;s design the <strong>UI</strong> needed for our <strong>app idea</strong>. The next step will be to complete our <strong>app</strong> by introducing <strong>ui updating</strong>.</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-ui.png" alt="UI"/></p><p>To create our UI we translate our mental screenshot...</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-screen.png" alt="screenshot"/></p><p>...to this <code>html</code>:</p><pre><code class="hljs language-html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br/>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Counter is now at <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;num&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br/>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;incbtn&quot;</span>&gt;</span>Increase<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span> by <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;number&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;amount&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br/>  <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br/><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre><h3 id="ui-updater-function">UI updater function</h3><p>Now that we now the <strong>state shape</strong> and the <strong>UI</strong>, we can define a <strong>UI updater</strong> function for our <strong>app</strong>!</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-uiupdate.png" alt="UI updater"/></p><p>The function updates the <strong>UI</strong> depending on the current <strong>state</strong>, which is passed in as an argument:</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> updateUI = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">state</span>) </span>{<br/>  <span class="hljs-keyword">var</span> element = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;num&quot;</span>);<br/>  element.innerHTML = state;<br/>};</code></pre><p>Since our <strong>state</strong> is just the current count, all we need to do is update the <code>#num</code> element with the <code>state</code>.</p><div class="smallnote">In a React app this would rather be a <strong>render</strong> function that defined the whole UI instead of mutating existing DOM.</div><h3 id="interaction">Interaction</h3><p>Now we can complete our <strong>app</strong> by introducing <strong>interaction</strong> through hooking up the <strong>action creators</strong> to the <strong>UI</strong> and dispatch the result to the <strong>store</strong>!</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-interaction.png" alt="interaction"/></p><p>We add a click handler to the <strong>button</strong>, which calls the <strong>action creator</strong> with the value from the <strong>input</strong>. The resulting action is passed to the <strong>store</strong>.</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> button = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;incbtn&quot;</span>);<br/>button.addEventListener(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{<br/>  <span class="hljs-keyword">var</span> input = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;amount&quot;</span>),<br/>    increase = <span class="hljs-built_in">parseInt</span>(input.value),<br/>    action = actionCreators.increment(increase);<br/>  store.dispatch(action);<br/>});</code></pre><div class="smallnote">Normally you wouldn&#x27;t let the views have a store reference like this, instead you&#x27;d use some kind of bridge to supply <code>dispatch</code> at setup time. In a React app you&#x27;d use the <a href="https://github.com/reactjs/react-redux">React-Redux</a> library which provides exactly such a bridge.</div><h3 id="application">Application</h3><p>We now have all the pieces we need to finalize our app!</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-example-map-app.png" alt="app"/></p><p>The only code we need to add is to have <strong>UI updater</strong> run whenever the <strong>store</strong> is updated and also run an initial rendering.</p><pre><code class="hljs language-javascript">store.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{<br/>  updateUI(store.getState());<br/>});<br/>updateUI(store.getState());</code></pre><p>Now our app is fully functional!</p><p>Here is the entire source code:</p><pre><code class="hljs language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br/><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br/>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>JS Bin<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://npmcdn.com/redux/dist/redux.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br/>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Counter is now at <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;num&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br/>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;incbtn&quot;</span>&gt;</span>Increase<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br/>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span> by <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br/>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;number&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;amount&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br/>    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"><br/>      <span class="hljs-keyword">var</span> initialstate = <span class="hljs-number">0</span>;<br/><br/>      <span class="hljs-keyword">var</span> reducer = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">state, action</span>) </span>{<br/>        <span class="hljs-keyword">switch</span> (action.type) {<br/>          <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;INCREMENT&quot;</span>:<br/>            <span class="hljs-keyword">return</span> state + action.by;<br/>          <span class="hljs-keyword">default</span>:<br/>            <span class="hljs-keyword">return</span> state;<br/>        }<br/>      };<br/><br/>      <span class="hljs-keyword">var</span> store = Redux.createStore(reducer, initialstate);<br/><br/>      <span class="hljs-keyword">var</span> actionCreators = {<br/>        <span class="hljs-attr">increment</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">int</span>) </span>{<br/>          <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;INCREMENT&quot;</span>, <span class="hljs-attr">by</span>: int };<br/>        },<br/>      };<br/><br/>      <span class="hljs-keyword">var</span> updateUI = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">state, arg2</span>) </span>{<br/>        <span class="hljs-keyword">var</span> element = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;num&quot;</span>);<br/>        element.innerHTML = state;<br/>      };<br/><br/>      <span class="hljs-keyword">var</span> button = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;incbtn&quot;</span>);<br/>      button.addEventListener(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{<br/>        <span class="hljs-keyword">var</span> input = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;amount&quot;</span>),<br/>          increase = <span class="hljs-built_in">parseInt</span>(input.value),<br/>          action = actionCreators.increment(increase);<br/>        store.dispatch(action);<br/>      });<br/><br/>      store.subscribe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{<br/>        updateUI(store.getState());<br/>      });<br/>      updateUI(store.getState());<br/>    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br/><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><p>And here is the app running in an iframe:</p><iframe src="/static/posts/a-redux-app-tutorial/applets/reduxminiexample/index.html" height="100px" width="100%"></iframe><p>For your convenience there&#x27;s also a JSBin <a href="https://jsbin.com/milini/edit?html,js,output">here</a>.</p><h3 id="the-redux-cycle">The Redux cycle</h3><p>Note how already this minimal example demonstrates the <strong>unidirectional data flow</strong>:</p><p><img src="/static/posts/a-redux-app-tutorial/img/redux-flow.png" alt="cycle"/></p><ol><li>We click a button in our &quot;component&quot;</li><li>the component calls an action creator</li><li>the result is dispatched to the store</li><li>which uses the reducer to calculate a new state</li><li>which causes <code>updateUI</code> to update the &quot;component&quot;!</li></ol><h3 id="wrapping-up">Wrapping up</h3><p>I realise the danger of this all being Much Ado About Nothing, but I hope that I to some extent was able to convey the Redux way of thinking. It is such a powerful paradigm once you&#x27;ve wrapped your head around it!</p><div class="smallnote">PS: This post is an (adapted) excerpt from a 2-day React+Redux training course that I provide through my employer Edument. So if you&#x27;re in Scandinavia and hungry for more, <a href="http://edument.se/en/training/webdevelopment/react-js">check it out</a>!</div></div><hr/></div><div id="disqus_thread" style="display:none"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"dataManager":"[]","props":{"pageProps":{}},"page":"/posts/a-redux-app-tutorial","query":{},"buildId":"wQeVqw4-MCmoY2Zy_p65E","dynamicBuildId":false,"nextExport":true}</script><script async="" id="__NEXT_PAGE__/posts/a-redux-app-tutorial" src="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/posts/a-redux-app-tutorial.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/_app.js"></script><script src="/_next/static/runtime/webpack-3df6523e264ff2ac6548.js" async=""></script><script src="/_next/static/chunks/commons.ebbfd942159f83091516.js" async=""></script><script src="/_next/static/runtime/main-c1620565ee9f1f33603c.js" async=""></script><script type="text/javascript" async="" src="https://krawaller.disqus.com/embed.js"></script></body></html>