<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="/static/styles/nprogress.css"/><link rel="stylesheet" href="/static/styles/code.css"/><link rel="stylesheet" href="/static/styles/site.css"/><link href="https://fonts.googleapis.com/css?family=Open+Sans&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Lexend+Zetta&amp;display=swap" rel="stylesheet"/><script async="" src="https://www.google-analytics.com/analytics.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-11433118-1', 'auto');
  ga("send", "pageview");</script><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta charSet="utf-8"/><title>A React.js case study</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/posts/a-react-js-case-study.js" as="script"/><link rel="preload" href="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-3df6523e264ff2ac6548.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.ebbfd942159f83091516.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-c1620565ee9f1f33603c.js" as="script"/></head><body><div id="__next"><div style="margin-bottom:20px"></div><div class="master"><h1><a href="/"><span>k</span><span>r</span><span>a</span><span>w</span><span>a</span><span>l</span><span>l</span><span>e</span><span>r</span></a></h1><hr/><div class="summary">This post dissects a memory game built with React, focusing on structure and the React way of thinking</div><hr/><h2>A React.js case study</h2><p class="taglist">Tags:<!-- --> <a href="/tags/react/">react</a><a href="/tags/case_study/">case study</a></p><div class="page-content"><div class="post" data-postid="getstartedwithreact"><p><span style="color:red"><strong>NOTE:</strong> Some code and conclusions expressed here are not idiomatic React. See the <a href="/posts/a-react-js-case-study-follow-up/">follow-up post</a> for more details!</span></p><h3 id="the-game">The game</h3><p>The last few days I&#x27;ve been toying with <a href="http://facebook.github.io/react/">React.js</a>, Facebook&#x27;s excellent view abstraction library. In order to grokk it I built a simple memory game, which we&#x27;ll dissect in this post.</p><p>First off, here&#x27;s the game running in a iframe (here&#x27;s a <a href="https://blog.krawaller.se/reactexperiment/">link</a> if you want it in a separate tab). The repo can be found <a href="https://github.com/krawaller/reactexperiment/">here</a>.</p><iframe src="https://blog.krawaller.se/reactexperiment/" style="height:240px;width:100%"></iframe><p>As you can see the game is rather simple, yet included enough state and compositions to force me to actually use React.</p><h3 id="the-code">The code</h3><p>This is the full contents of the repo:</p><img src="/static/posts/a-react-js-case-study/img/reactexperimentsource.png" style="margin-left:4em"/><p>The <code>lib</code> folder contains the only 3 dependencies:</p><ul><li><code>react.js</code> is the react librabry itself. We don&#x27;t need the add-on version, just plain vanilla React.</li><li><code>JSXTransformer.js</code> translates the JSX syntax. In production this should of course be part of the build process.</li><li><code>lodash.js</code> is used merely to make for some cleaner code in the game logic.</li></ul><p>The <code>src</code> folder then contains files for all of our React components. The hierarchy looks like thus:</p><img src="/static/posts/a-react-js-case-study/img/reactexperiment.png" style="height:200px;margin-left:4em"/><p>Finally <code>index.html</code> is a super simple bootstrap kicking it all off:</p><pre><code class="hljs language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br/><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br/>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;lib/lodash.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;lib/react.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;lib/JSXTransformer.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/jsx&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;src/status.jsx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/jsx&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;src/board.jsx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/jsx&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;src/game.jsx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/jsx&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;src/wordform.jsx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/jsx&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;src/tile.jsx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;styles.css&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">link</span>&gt;</span><br/>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br/>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br/>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/jsx&quot;</span>&gt;</span><span class="javascript"><br/>      <span class="hljs-comment">/** <span class="hljs-doctag">@jsx </span>React.DOM */</span><br/><br/>      React.renderComponent(<br/>        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Game</span> /&gt;</span></span>,<br/>        <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&quot;body&quot;</span>)<br/>      );<br/>    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br/>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br/><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><p>We&#x27;ll now walk through each of the five React components, and how they map to the fundamental React principle; initial data that won&#x27;t change should be passed to a component as a property, while changing data should be handle in a component&#x27;s <code>state</code>. If we need to communicate from a child to a parent, we do this by calling a callback that was passed to the child as a property.</p><h3 id="the-game-component">The Game component</h3><p>First off is the Game component. It is responsible for switching between the form and the board, and passing data from the form to the board.</p><pre><code class="hljs language-javascript"><span class="hljs-comment">/** <span class="hljs-doctag">@jsx </span>React.DOM */</span><br/><br/><span class="hljs-keyword">var</span> Game = React.createClass({<br/>  <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">return</span> { <span class="hljs-attr">playing</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">tiles</span>: [] };<br/>  },<br/>  <span class="hljs-attr">startGame</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">words</span>) </span>{<br/>    <span class="hljs-built_in">this</span>.setState({<br/>      <span class="hljs-attr">tiles</span>: _.shuffle(words.concat(words)),<br/>      <span class="hljs-attr">playing</span>: <span class="hljs-literal">true</span>,<br/>      <span class="hljs-attr">seed</span>: <span class="hljs-built_in">Math</span>.random()<br/>    });<br/>  },<br/>  <span class="hljs-attr">endGame</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">playing</span>: <span class="hljs-literal">false</span> });<br/>  },<br/>  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">return</span> (<br/>      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{this.state.playing</span> ? &quot;<span class="hljs-attr">hidden</span>&quot; <span class="hljs-attr">:</span> &quot;<span class="hljs-attr">showing</span>&quot;}&gt;</span><br/>          <span class="hljs-tag">&lt;<span class="hljs-name">Wordform</span> <span class="hljs-attr">startGame</span>=<span class="hljs-string">{this.startGame}</span> /&gt;</span><br/>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{this.state.playing</span> ? &quot;<span class="hljs-attr">showing</span>&quot; <span class="hljs-attr">:</span> &quot;<span class="hljs-attr">hidden</span>&quot;}&gt;</span><br/>          <span class="hljs-tag">&lt;<span class="hljs-name">Board</span><br/>            <span class="hljs-attr">endGame</span>=<span class="hljs-string">{this.endGame}</span><br/>            <span class="hljs-attr">tiles</span>=<span class="hljs-string">{this.state.tiles}</span><br/>            <span class="hljs-attr">key</span>=<span class="hljs-string">{this.state.seed}</span><br/>          /&gt;</span><br/>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br/>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br/>    );<br/>  }<br/>});</code></pre><table><thead><tr><th>Props</th><th>State</th><th>Sub components</th><th>Instance variables</th></tr></thead><tbody><tr><td></td><td>playing<br/>tiles</td><td>Wordform<br/>Board</td><td></td></tr></tbody></table><p>The <code>Game</code> component has two <code>state</code> variables:</p><ul><li><code>playing</code> which controls which sub component to show or hide.</li><li><code>tiles</code> which contain the words passed to <code>startGame</code>, which will be triggered inside <code>Wordform</code>.</li></ul><p><code>Game</code> has two sub components:</p><ul><li><code>Wordform</code>, which it passes the <code>startGame</code> method.</li><li><code>Board</code>, which is passed the <code>endGame</code> method and the <code>tiles</code>.</li></ul><p>Note that <code>Game</code> always renders both the <code>Board</code> and the <code>Wordform</code>. This has to do with React component lifecycles. I first tried to do this:</p><pre><code class="hljs"><span class="hljs-keyword">return</span> (<br/>  &lt;div&gt;{<span class="hljs-keyword">this</span>.state.playing ? &lt;Board endGame={<span class="hljs-keyword">this</span>.endGame} tiles={<span class="hljs-keyword">this</span>.state.tiles}/&gt; : &lt;Wordform startGame={<span class="hljs-keyword">this</span>.startGame} /&gt;}&lt;/div&gt;<br/>);</code></pre><p>...which actually worked, but generated a React error message about an unmounted component. The official docs also state that instead of generating different components, we should generate them all and show/hide them as needed.</p><p>Also related to the life cycle of a component is the <code>key</code> property of the <code>Board</code>. Changing <code>key</code> ensures we have a new <code>Board</code> instance whenever we enter new words in the form, otherwise React will just repopulate the existing <code>Board</code> with new words. That means that previously flipped tiles will still be flipped, even though they now contain new words. Remove the <code>key</code> property and try it!</p><h3 id="the-wordform-component">The Wordform component</h3><p>This component displays a form for entering words to be used as tiles.</p><pre><code class="hljs language-javascript"><span class="hljs-comment">/** <span class="hljs-doctag">@jsx </span>React.DOM */</span><br/><br/><span class="hljs-keyword">var</span> Wordform = React.createClass({<br/>  <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">return</span> { <span class="hljs-attr">error</span>: <span class="hljs-string">&quot;&quot;</span> };<br/>  },<br/>  <span class="hljs-attr">setError</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg</span>) </span>{<br/>    <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">error</span>: msg });<br/>    <span class="hljs-built_in">setTimeout</span>(<br/>      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>        <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">error</span>: <span class="hljs-string">&quot;&quot;</span> });<br/>      }.bind(<span class="hljs-built_in">this</span>),<br/>      <span class="hljs-number">2000</span><br/>    );<br/>  },<br/>  <span class="hljs-attr">submitWords</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{<br/>    <span class="hljs-keyword">var</span> node = <span class="hljs-built_in">this</span>.refs[<span class="hljs-string">&quot;wordfield&quot;</span>].getDOMNode(),<br/>      words = (node.value || <span class="hljs-string">&quot;&quot;</span>)<br/>        .trim()<br/>        .replace(<span class="hljs-regexp">/\W+/g</span>, <span class="hljs-string">&quot; &quot;</span>)<br/>        .split(<span class="hljs-string">&quot; &quot;</span>);<br/>    <span class="hljs-keyword">if</span> (words.length &lt;= <span class="hljs-number">2</span>) {<br/>      <span class="hljs-built_in">this</span>.setError(<span class="hljs-string">&quot;Enter at least 3 words!&quot;</span>);<br/>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (words.length !== _.unique(words).length) {<br/>      <span class="hljs-built_in">this</span>.setError(<span class="hljs-string">&quot;Words should be unique!&quot;</span>);<br/>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<br/>      _.filter(words, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">w</span>) </span>{<br/>        <span class="hljs-keyword">return</span> w.length &gt; <span class="hljs-number">8</span>;<br/>      }).length<br/>    ) {<br/>      <span class="hljs-built_in">this</span>.setError(<span class="hljs-string">&quot;Words should not be longer than 8 characters!&quot;</span>);<br/>    } <span class="hljs-keyword">else</span> {<br/>      <span class="hljs-built_in">this</span>.props.startGame(words);<br/>      node.value = <span class="hljs-string">&quot;&quot;</span>;<br/>    }<br/>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br/>  },<br/>  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">return</span> (<br/>      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{this.submitWords}</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Enter words separated by spaces!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;wordfield&quot;</span> /&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>Start!<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;error&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;errormsg&quot;</span>&gt;</span><br/>          {this.state.error}<br/>        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br/>      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><br/>    );<br/>  }<br/>});</code></pre><table><thead><tr><th>Props</th><th>State</th><th>Sub components</th><th>Instance variables</th></tr></thead><tbody><tr><td>startGame()</td><td>error</td><td></td><td></td></tr></tbody></table><p>The <code>Wordform</code> component validates the input and passes it back up to <code>Game</code> by calling the <code>startGame</code> method which it received as a property.</p><p>In order to collect the contents of the input field we use the <code>refs</code> instance property, with the same key (<code>wordfield</code>) as given to the <code>ref</code> property of the corresponding node in the render output.</p><p>Note how showing and hiding error messages are done through changing the <code>error</code> state variable, which triggers the rerender. It feels almost like we have a two-way data binding!</p><h3 id="the-board-component">The Board component</h3><p>Here&#x27;s the code for the <code>Board</code> component, which displays the game board:</p><pre><code class="hljs language-javascript"><span class="hljs-comment">/** <span class="hljs-doctag">@jsx </span>React.DOM */</span><br/><br/><span class="hljs-keyword">var</span> Board = React.createClass({<br/>  <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">return</span> { <span class="hljs-attr">found</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;choosetile&quot;</span> };<br/>  },<br/>  <span class="hljs-attr">clickedTile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tile</span>) </span>{<br/>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.wait) {<br/>      <span class="hljs-comment">// turn up lone tile</span><br/>      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.flippedtile) {<br/>        <span class="hljs-built_in">this</span>.flippedtile = tile;<br/>        tile.reveal();<br/>        <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;findmate&quot;</span> });<br/>        <span class="hljs-comment">// clicked second</span><br/>      } <span class="hljs-keyword">else</span> {<br/>        <span class="hljs-built_in">this</span>.wait = <span class="hljs-literal">true</span>;<br/>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.flippedtile.props.word === tile.props.word) {<br/>          <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">found</span>: <span class="hljs-built_in">this</span>.state.found + <span class="hljs-number">1</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;foundmate&quot;</span> });<br/>          tile.succeed();<br/>          <span class="hljs-built_in">this</span>.flippedtile.succeed();<br/>        } <span class="hljs-keyword">else</span> {<br/>          <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;wrong&quot;</span> });<br/>          tile.fail();<br/>          <span class="hljs-built_in">this</span>.flippedtile.fail();<br/>        }<br/>        <span class="hljs-built_in">setTimeout</span>(<br/>          <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>            <span class="hljs-built_in">this</span>.wait = <span class="hljs-literal">false</span>;<br/>            <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;choosetile&quot;</span> });<br/>            <span class="hljs-keyword">delete</span> <span class="hljs-built_in">this</span>.flippedtile;<br/>          }.bind(<span class="hljs-built_in">this</span>),<br/>          <span class="hljs-number">2000</span><br/>        );<br/>      }<br/>    }<br/>  },<br/>  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">var</span> tiles = <span class="hljs-built_in">this</span>.props.tiles.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">b, n</span>) </span>{<br/>      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Tile</span> <span class="hljs-attr">word</span>=<span class="hljs-string">{b}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{n}</span> <span class="hljs-attr">clickedTile</span>=<span class="hljs-string">{this.clickedTile}</span> /&gt;</span></span>;<br/>    }, <span class="hljs-built_in">this</span>);<br/>    <span class="hljs-keyword">return</span> (<br/>      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.props.endGame}</span>&gt;</span>End game<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">Status</span><br/>          <span class="hljs-attr">found</span>=<span class="hljs-string">{this.state.found}</span><br/>          <span class="hljs-attr">max</span>=<span class="hljs-string">{this.props.tiles.length</span> / <span class="hljs-attr">2</span>}<br/>          <span class="hljs-attr">message</span>=<span class="hljs-string">{this.state.message}</span><br/>        /&gt;</span><br/>        {tiles}<br/>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br/>    );<br/>  }<br/>});</code></pre><table><thead><tr><th>Props</th><th>State</th><th>Sub components</th><th>Instance variables</th></tr></thead><tbody><tr><td>tiles<br/>endGame()</td><td>found<br/>message</td><td>Status<br/>Tile</td><td>wait<br/>flippedtile</td></tr></tbody></table><p>The Board component was passed a <code>tiles</code> array and an <code>endGame</code> callback from its parent.</p><p>It has two state variables:</p><ul><li><code>found</code> which counts how many pairs the player has found</li><li><code>message</code> which contains the id of the message to display to the player</li></ul><p>When rendered it contains two different sub components:</p><ul><li><code>Status</code>, which is passed <code>found</code>, <code>max</code> and <code>message</code>. This component deals with the instruction to the player above the tiles.</li><li><code>Tile</code>, which represents an individual tile. Each tile is passed a <code>word</code> and the <code>clickedTile</code> callback.</li></ul><p>The <code>clickedTile</code> callback will be called from the individual tiles, with the tile instance as parameter. As you can see, this method contains the full logic for the actual game.</p><p>Note how this method uses the instance variables <code>this.wait</code> and <code>this.flippedtile</code>. These do NOT need to be <code>state</code> variables, as they don&#x27;t affect the rendering! Only state which might affect what the component looks like need to be stored using <code>this.setState</code>.</p><h3 id="the-status-component">The Status component</h3><pre><code class="hljs language-javascript"><span class="hljs-comment">/** <span class="hljs-doctag">@jsx </span>React.DOM */</span><br/><br/>This component renders the info row above the game board.<br/><br/>var Status = React.createClass({<br/>  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">var</span> found = <span class="hljs-built_in">this</span>.props.found,<br/>        max = <span class="hljs-built_in">this</span>.props.max,<br/>        texts = {<br/>          <span class="hljs-attr">choosetile</span>:<span class="hljs-string">&quot;Choose a tile!&quot;</span>,<br/>          <span class="hljs-attr">findmate</span>:<span class="hljs-string">&quot;Now try to find the matching tile!&quot;</span>,<br/>          <span class="hljs-attr">wrong</span>:<span class="hljs-string">&quot;Sorry, those didn&#x27;t match!&quot;</span>,<br/>          <span class="hljs-attr">foundmate</span>:<span class="hljs-string">&quot;Yey, they matched!&quot;</span>,<br/>          <span class="hljs-attr">foundall</span>:<span class="hljs-string">&quot;You&#x27;ve found all &quot;</span>+max+<span class="hljs-string">&quot; pairs! Well done!&quot;</span><br/>        };<br/>    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>({found}/{max})<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span>{texts[this.props.message === &quot;choosetile&quot; &amp;&amp; found === max ? &quot;foundall&quot; : this.props.message]}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;<br/>  }<br/>});</code></pre><table><thead><tr><th>Props</th><th>State</th><th>Sub components</th><th>Instance variables</th></tr></thead><tbody><tr><td>found<br/>max<br/>message</td><td></td><td></td><td></td></tr></tbody></table><p>The <code>Status</code> component was passed <code>found</code>, <code>max</code> and <code>message</code> from its parent. It then bakes this together into a UI info row.</p><p>Note how even though the status row is constantly changing while playing, this is a totally static component. It contains no state variables, and all updates are controlled in the parent!</p><h3 id="the-tile-component">The Tile component</h3><p>This component represents an individual tile.</p><pre><code class="hljs language-javascript"><span class="hljs-comment">/** <span class="hljs-doctag">@jsx </span>React.DOM */</span><br/><br/><span class="hljs-keyword">var</span> Tile = React.createClass({<br/>  <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">return</span> { <span class="hljs-attr">flipped</span>: <span class="hljs-literal">false</span> };<br/>  },<br/>  <span class="hljs-attr">catchClick</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.state.flipped) {<br/>      <span class="hljs-built_in">this</span>.props.clickedTile(<span class="hljs-built_in">this</span>);<br/>    }<br/>  },<br/>  <span class="hljs-attr">reveal</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">flipped</span>: <span class="hljs-literal">true</span> });<br/>  },<br/>  <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">flipped</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">wrong</span>: <span class="hljs-literal">true</span> });<br/>    <span class="hljs-built_in">setTimeout</span>(<br/>      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>        <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">flipped</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">wrong</span>: <span class="hljs-literal">false</span> });<br/>      }.bind(<span class="hljs-built_in">this</span>),<br/>      <span class="hljs-number">2000</span><br/>    );<br/>  },<br/>  <span class="hljs-attr">succeed</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-built_in">this</span>.setState({ <span class="hljs-attr">flipped</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">correct</span>: <span class="hljs-literal">true</span> });<br/>  },<br/>  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{<br/>    <span class="hljs-keyword">var</span> classes = _.reduce(<br/>      [<span class="hljs-string">&quot;flipped&quot;</span>, <span class="hljs-string">&quot;correct&quot;</span>, <span class="hljs-string">&quot;wrong&quot;</span>],<br/>      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">m, c</span>) </span>{<br/>        <span class="hljs-keyword">return</span> m + (<span class="hljs-built_in">this</span>.state[c] ? c + <span class="hljs-string">&quot; &quot;</span> : <span class="hljs-string">&quot;&quot;</span>);<br/>      },<br/>      <span class="hljs-string">&quot;&quot;</span>,<br/>      <span class="hljs-built_in">this</span><br/>    );<br/>    <span class="hljs-keyword">return</span> (<br/>      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>&quot;<span class="hljs-attr">brick</span> &quot; + (<span class="hljs-attr">classes</span> || &quot;&quot;)} <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.catchClick}</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;front&quot;</span>&gt;</span>?<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br/>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;back&quot;</span>&gt;</span>{this.props.word}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br/>      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br/>    );<br/>  }<br/>});</code></pre><table><thead><tr><th>Props</th><th>State</th><th>Sub components</th><th>Instance variables</th></tr></thead><tbody><tr><td>word<br/>clickedTile()</td><td>flipped<br/>wrong<br/>correct</td><td></td><td></td></tr></tbody></table><p>It was passed two properties from the parent; a <code>word</code> variable and a <code>clickedTile</code> callback.</p><p>The component has three <code>state</code> variables:</p><ul><li><code>flipped</code> is a flag to show if the tile has been flipped up or not. While flipped it will not receive clicks.</li><li><code>wrong</code> is true if the tile was part of a failed match attempt.</li><li><code>correct</code> is true if the tile has been matched to a partner.</li></ul><p>When clicked the component will call the <code>clickedTile</code> callback passing itself as a parameter. All game logic is in <code>Board</code>, as we saw previously.</p><h3 id="wrapping-up">Wrapping up</h3><p>I&#x27;m totally in love with React! It took a while to grasp the thinking, like for example the differentiation between <code>state</code> and <code>props</code>, and how <code>state</code> can belong in <code>props</code> when passed to a child. But when that mentality was in place, putting it all together was a breeze. I really appreciate not having to write any update or cleanup code (I&#x27;m looking at you, Backbone), delegating all that headache to React!</p><p>Passing callbacks to allow for upstream communication can feel a bit clunky, and I look forward to trying out the Flux approach instead. I also want to integrate a Router, and see how that plays along with it all.</p><p><span style="color:red"><strong>NOTE:</strong> If you haven&#x27;t already, check out the <a href="/posts/a-react-js-case-study-follow-up/">follow-up post</a> for a detailed refactoring of the code to be more idiomatic to React!</span></p></div><hr/></div><div id="disqus_thread" style="display:none"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"dataManager":"[]","props":{"pageProps":{}},"page":"/posts/a-react-js-case-study","query":{},"buildId":"wQeVqw4-MCmoY2Zy_p65E","dynamicBuildId":false,"nextExport":true}</script><script async="" id="__NEXT_PAGE__/posts/a-react-js-case-study" src="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/posts/a-react-js-case-study.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/wQeVqw4-MCmoY2Zy_p65E/pages/_app.js"></script><script src="/_next/static/runtime/webpack-3df6523e264ff2ac6548.js" async=""></script><script src="/_next/static/chunks/commons.ebbfd942159f83091516.js" async=""></script><script src="/_next/static/runtime/main-c1620565ee9f1f33603c.js" async=""></script><script type="text/javascript" async="" src="https://krawaller.disqus.com/embed.js"></script></body></html>