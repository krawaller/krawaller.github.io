(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"3kEV":function(e,a,t){"use strict";t.r(a);var l=t("q1tI"),n=t.n(l),s=t("JRaF"),r=(t("YFqc"),{url:"algebra-explorer-a-symbolic-calculator-web-app",id:"algebraexplorer",title:"Algebra Explorer - a symbolic calculator web app",author:"david",tags:["algebra explorer","testing","education"],date:"2014-12-30",excerpt:"Introducing a symbolic calculator built on the web stack and peeping under the hood",type:"post",folder:"/Users/davidwaller/gitreps/mine/blog2/sources/2014-12-30_algebraexplorer",hasStaticContent:!0,headlines:[{level:3,text:"The project",id:"the-project"},{level:3,text:"Payment model",id:"payment-model"},{level:3,text:"Tech stack",id:"tech-stack"},{level:3,text:"Algebraic representation",id:"algebraic-representation"},{level:3,text:"Substeps under the hood",id:"substeps-under-the-hood"},{level:3,text:"Localization",id:"localization"},{level:3,text:"Regular expressions ftw",id:"regular-expressions-ftw"},{level:3,text:"Unit testing with Vows",id:"unit-testing-with-vows"},{level:3,text:"Wrapping up",id:"wrapping-up"}]});a.default=function(){return n.a.createElement(s.a,{kind:"post",data:r,title:"Algebra Explorer - a symbolic calculator web app",summary:"Introducing a symbolic calculator built on the web stack and peeping under the hood",headlines:[{level:3,text:"The project",id:"the-project"},{level:3,text:"Payment model",id:"payment-model"},{level:3,text:"Tech stack",id:"tech-stack"},{level:3,text:"Algebraic representation",id:"algebraic-representation"},{level:3,text:"Substeps under the hood",id:"substeps-under-the-hood"},{level:3,text:"Localization",id:"localization"},{level:3,text:"Regular expressions ftw",id:"regular-expressions-ftw"},{level:3,text:"Unit testing with Vows",id:"unit-testing-with-vows"},{level:3,text:"Wrapping up",id:"wrapping-up"}],tags:["algebra explorer","testing","education"]},n.a.createElement("div",{className:"post","data-postid":"algebraexplorer"},n.a.createElement("h3",{id:"the-project"},"The project"),n.a.createElement("p",null,"For several years now I've tried to combine my programming self with my maths teacher alter ego by working on a symbolic calculator that would show the substeps of the manipulations made, to allow people to more easily understand the intricacies of algebra. Now I'm finally finished, and I am ever so happy to present to you - Algebra Explorer!"),n.a.createElement("p",{style:{textAlign:"center"}},n.a.createElement("img",{src:"/static/posts/algebra-explorer-a-symbolic-calculator-web-app/img/alexscreen.png"})),n.a.createElement("p",null,"You can find out more by visiting ",n.a.createElement("a",{href:"http://www.algebraexplorer.com"},"the homepage"),", but as it is a web app you can also try it out right here by clicking the button below!"),n.a.createElement("p",null,n.a.createElement("button",{className:"launchbutton",style:{display:"block",margin:"0 auto"}},"Launch Algebra Explorer")),n.a.createElement("p",null,"This post won't talk too much about the pedagogical side or the app functionality, but instead relate how the app was built."),n.a.createElement("h3",{id:"payment-model"},"Payment model"),n.a.createElement("p",null,"After trying out some different approaches I decided to make the app freely available online, and charge for an iOS version (Android planned too, but so far I haven't managed to bring myself to fix that). Since the online version works fine in a mobile browser too the app really isn't necessary, but useful if you want an offline version or just want to support the project."),n.a.createElement("p",null,"Time will tell if this model is at all viable, but at this point I'm not too bothered by revenue - I'll never ever get back what my spent unpaid time is worth anyway. And also it seemed like a nice way to leverage the power of the web stack."),n.a.createElement("h3",{id:"tech-stack"},"Tech stack"),n.a.createElement("p",null,"As I have been toiling away at this project for years and years and ",n.a.createElement("em",null,"years")," (I remember sketching out the prototype on the whiteboard of the school in Blacklake prison in 2007), the choices regarding building blocks are not what present day David would make. But, here we go:"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("strong",null,"CoffeeScript:")," Yeah, I know, I'm sorry. When I started (this version of the codebase) CS was all the craze, and I had my seat on the train. But I must say, diving down that rabbit hole definitely made me a stronger JS programmer!"),n.a.createElement("li",null,n.a.createElement("strong",null,"Backbone:")," Maybe not that bad of a fit, as my needs were rather specific and Backbone gave me lots of freedom."),n.a.createElement("li",null,n.a.createElement("strong",null,"Vows:")," I'll talk some more about the unit testing towards the end of this post."),n.a.createElement("li",null,n.a.createElement("strong",null,"Mathjax:")," For displaying mathematics in browsers without native support for MathML."),n.a.createElement("li",null,n.a.createElement("strong",null,"Cordova:")," Initially I used the ",n.a.createElement("a",{href:"https://build.phonegap.com/"},"phonegap build service"),", but their repo size limit and other weirdness made me eventually install Cordova locally instead.")),n.a.createElement("p",null,"Other than that, I built everything myself. This was more ignorance than pride; for example, had I known more about parsing theory I would have used a library as a foundation for my own instead of doing everything from scratch."),n.a.createElement("h3",{id:"algebraic-representation"},"Algebraic representation"),n.a.createElement("p",null,"First off I designed my own data format for mathematics. It is very simple; everything expression has a ",n.a.createElement("code",null,"type"),", some have a ",n.a.createElement("code",null,"val")," and some have ",n.a.createElement("code",null,"objs")," (meaning children). Here is a regular number:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-json"},"{",n.a.createElement("br",null),"  ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"number"'),",",n.a.createElement("br",null),"  ",n.a.createElement("span",{className:"hljs-attr"},'"val"'),": ",n.a.createElement("span",{className:"hljs-number"},"7"),n.a.createElement("br",null),"}")),n.a.createElement("p",null,"Here is the sum ",n.a.createElement("code",null,"x+pi/(4^3)"),":"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-json"},"{",n.a.createElement("br",null),"  ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"sum"'),",",n.a.createElement("br",null),"  ",n.a.createElement("span",{className:"hljs-attr"},'"objs"'),": [",n.a.createElement("br",null),"    {",n.a.createElement("br",null),"      ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"variable"'),",",n.a.createElement("br",null),"      ",n.a.createElement("span",{className:"hljs-attr"},'"val"'),": ",n.a.createElement("span",{className:"hljs-string"},'"x"'),n.a.createElement("br",null),"    },",n.a.createElement("br",null),"    {",n.a.createElement("br",null),"      ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"fraction"'),",",n.a.createElement("br",null),"      ",n.a.createElement("span",{className:"hljs-attr"},'"objs"'),": [",n.a.createElement("br",null),"        {",n.a.createElement("br",null),"          ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"constant"'),",",n.a.createElement("br",null),"          ",n.a.createElement("span",{className:"hljs-attr"},'"val"'),": ",n.a.createElement("span",{className:"hljs-string"},'"pi"'),n.a.createElement("br",null),"        },",n.a.createElement("br",null),"        {",n.a.createElement("br",null),"          ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"power"'),",",n.a.createElement("br",null),"          ",n.a.createElement("span",{className:"hljs-attr"},'"objs"'),": [",n.a.createElement("br",null),"            {",n.a.createElement("br",null),"              ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"number"'),",",n.a.createElement("br",null),"              ",n.a.createElement("span",{className:"hljs-attr"},'"val"'),": ",n.a.createElement("span",{className:"hljs-number"},"4"),n.a.createElement("br",null),"            },",n.a.createElement("br",null),"            {",n.a.createElement("br",null),"              ",n.a.createElement("span",{className:"hljs-attr"},'"type"'),": ",n.a.createElement("span",{className:"hljs-string"},'"number"'),",",n.a.createElement("br",null),"              ",n.a.createElement("span",{className:"hljs-attr"},'"val"'),": ",n.a.createElement("span",{className:"hljs-number"},"3"),n.a.createElement("br",null),"            }",n.a.createElement("br",null),"          ]",n.a.createElement("br",null),"        }",n.a.createElement("br",null),"      ]",n.a.createElement("br",null),"    }",n.a.createElement("br",null),"  ]",n.a.createElement("br",null),"}")),n.a.createElement("h3",{id:"substeps-under-the-hood"},"Substeps under the hood"),n.a.createElement("p",null,"The main pedagogical idea behind the app was to show substeps of everything, and not sweeping anything under the rug. Complex rules should break down into a small set of basic truths. I used this same approach under the hood; the basic truths, which I call atomic operations, all return a maths expression, while composite operations explicitly use other operations."),n.a.createElement("p",null,"For example, consider the basic truth that we can always remove an exponent 1 from a power. No matter what the value of the base is, an exponent of 1 can be removed. Here is the source code for this atomic operation:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-coffeescript"},"oneExpPowerToBase = ",n.a.createElement("span",{className:"hljs-comment"},"# x^1 = x"),n.a.createElement("br",null),"    info:",n.a.createElement("br",null),"        name: ",n.a.createElement("span",{className:"hljs-string"},'"oneExpPowerToBase"'),n.a.createElement("br",null),"        effect: ",n.a.createElement("span",{className:"hljs-string"},'"simplifying"'),n.a.createElement("br",null),"        opposite: ",n.a.createElement("span",{className:"hljs-string"},'"raiseByOne"'),n.a.createElement("br",null),"        example: ",n.a.createElement("span",{className:"hljs-string"},'"x^1"'),n.a.createElement("br",null),"        tags: [",n.a.createElement("span",{className:"hljs-string"},'"exponentiation"'),",",n.a.createElement("span",{className:"hljs-string"},'"power"'),",",n.a.createElement("span",{className:"hljs-string"},'"number1"'),",",n.a.createElement("span",{className:"hljs-string"},'"remove"'),",",n.a.createElement("span",{className:"hljs-string"},'"neutralelement"'),"]",n.a.createElement("br",null),"        lesson: ",n.a.createElement("span",{className:"hljs-string"},'"power101"'),n.a.createElement("br",null),"    prints:",n.a.createElement("br",null),"        errors: [",n.a.createElement("span",{className:"hljs-string"},'"expmustbeone"'),"]",n.a.createElement("br",null),"    target:",n.a.createElement("br",null),"        type: ",n.a.createElement("span",{className:"hljs-string"},'"power"'),n.a.createElement("br",null),"        validate: ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-params"},"({deps,target:objs:[base,exp]})"),"->")," ",n.a.createElement("span",{className:"hljs-keyword"},"if")," ",n.a.createElement("span",{className:"hljs-keyword"},"not")," deps.equal exp, one ",n.a.createElement("span",{className:"hljs-keyword"},"then")," Err ",n.a.createElement("span",{className:"hljs-string"},'"expmustbeone"'),", [",n.a.createElement("span",{className:"hljs-number"},"1"),"] ",n.a.createElement("span",{className:"hljs-keyword"},"else")," OK",n.a.createElement("br",null),"    perform: ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-params"},"({target})"),"->"),n.a.createElement("br",null),"        result: target.objs[",n.a.createElement("span",{className:"hljs-number"},"0"),"]",n.a.createElement("br",null),"        beforemarks: [[",n.a.createElement("span",{className:"hljs-number"},"1"),"]]")),n.a.createElement("p",null,"Note how the ",n.a.createElement("code",null,"result")," when calling ",n.a.createElement("code",null,"perform")," will be ",n.a.createElement("code",null,"target.objs[0]"),'. Since the target of the operation is always a power, what is returned is the first child of the power, namely the base. And of course this is what remains if we "remove" the exponent.'),n.a.createElement("p",null,"Now consider the rule that if a power has an exponent of 0, it is equal to 1 (actually it is not quite that simple since the base cannot be 0 too, but never mind that for now). This is ",n.a.createElement("em",null,"not")," a basic truth, but a consequence of the above rule and several other rules. Here's what this looks like in the app:"),n.a.createElement("p",{style:{textAlign:"center"}},n.a.createElement("img",{src:"/static/posts/algebra-explorer-a-symbolic-calculator-web-app/img/alexsubsteps.png"})),n.a.createElement("p",null,"And here is the source code for this operation, where you can see it explicitly calling each substep:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-coffeescript"},"zeroExpPowerToOne = ",n.a.createElement("span",{className:"hljs-comment"},"# x^0 = 1"),n.a.createElement("br",null),"    info:",n.a.createElement("br",null),"        name: ",n.a.createElement("span",{className:"hljs-string"},'"zeroExpPowerToOne"'),n.a.createElement("br",null),"        effect: ",n.a.createElement("span",{className:"hljs-string"},'"simplifying"'),n.a.createElement("br",null),"        example: ",n.a.createElement("span",{className:"hljs-string"},'"x^0"'),n.a.createElement("br",null),"        uses: [",n.a.createElement("span",{className:"hljs-string"},'"numToSum"'),",",n.a.createElement("span",{className:"hljs-string"},'"biSumExpPowToProd"'),",",n.a.createElement("span",{className:"hljs-string"},'"oneExpPowerToBase"'),",",n.a.createElement("span",{className:"hljs-string"},'"negExpFacProdToFrac"'),",",n.a.createElement("span",{className:"hljs-string"},'"sameNumerDenomFracToOne"'),"]",n.a.createElement("br",null),"        tags: [",n.a.createElement("span",{className:"hljs-string"},'"exponentiation"'),",",n.a.createElement("span",{className:"hljs-string"},'"number1"'),",",n.a.createElement("span",{className:"hljs-string"},'"number0"'),",",n.a.createElement("span",{className:"hljs-string"},'"power"'),",",n.a.createElement("span",{className:"hljs-string"},'"collapse"'),",",n.a.createElement("span",{className:"hljs-string"},'"neutralelement"'),"]",n.a.createElement("br",null),"        opposite: ",n.a.createElement("span",{className:"hljs-string"},'"oneToZeroExpPower"'),n.a.createElement("br",null),"        lesson: ",n.a.createElement("span",{className:"hljs-string"},'"powernegexp"'),n.a.createElement("br",null),"    prints:",n.a.createElement("br",null),"        errors: [",n.a.createElement("span",{className:"hljs-string"},'"expmustbezero"'),"]",n.a.createElement("br",null),"    target:",n.a.createElement("br",null),"        type: ",n.a.createElement("span",{className:"hljs-string"},'"power"'),n.a.createElement("br",null),"        validate: ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-params"},"({deps,target:objs:[base,exp]})"),"->")," ",n.a.createElement("span",{className:"hljs-keyword"},"if")," ",n.a.createElement("span",{className:"hljs-keyword"},"not")," deps.equal exp, zero ",n.a.createElement("span",{className:"hljs-keyword"},"then")," Err ",n.a.createElement("span",{className:"hljs-string"},'"expmustbezero"'),", [",n.a.createElement("span",{className:"hljs-number"},"1"),"] ",n.a.createElement("span",{className:"hljs-keyword"},"else")," OK",n.a.createElement("br",null),"    perform: ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-params"},"(o)"),"->"),n.a.createElement("br",null),"        o.",n.a.createElement("span",{className:"hljs-keyword"},"do")," ",n.a.createElement("span",{className:"hljs-string"},'"numToSum"'),",",n.a.createElement("span",{className:"hljs-string"},'"turnzeroexpto1minus1"'),",aim:[",n.a.createElement("span",{className:"hljs-number"},"1"),"],argument: Sum one,Neg one",n.a.createElement("br",null),"        o.",n.a.createElement("span",{className:"hljs-keyword"},"do")," ",n.a.createElement("span",{className:"hljs-string"},'"biSumExpPowToProd"'),",",n.a.createElement("span",{className:"hljs-string"},'"splitpow"'),n.a.createElement("br",null),"        o.",n.a.createElement("span",{className:"hljs-keyword"},"do")," ",n.a.createElement("span",{className:"hljs-string"},'"oneExpPowerToBase"'),",",n.a.createElement("span",{className:"hljs-string"},'"dropexp1"'),",aim:[",n.a.createElement("span",{className:"hljs-number"},"0"),"]",n.a.createElement("br",null),"        o.",n.a.createElement("span",{className:"hljs-keyword"},"do")," ",n.a.createElement("span",{className:"hljs-string"},'"negExpFacProdToFrac"'),",",n.a.createElement("span",{className:"hljs-string"},'"movetodenom"'),",selection:[[",n.a.createElement("span",{className:"hljs-number"},"1"),"]]",n.a.createElement("br",null),"        o.",n.a.createElement("span",{className:"hljs-keyword"},"do")," ",n.a.createElement("span",{className:"hljs-string"},'"sameNumerDenomFracToOne"'),",",n.a.createElement("span",{className:"hljs-string"},'"andcollapsefracto1"'),n.a.createElement("br",null),"        o.beforemark [[",n.a.createElement("span",{className:"hljs-number"},"1"),"]]")),n.a.createElement("p",null,"Modelling the code this way made it easier for me to show the substeps for the user, as the end result of a ",n.a.createElement("code",null,"simplify")," call will be a nested object with each step info retained. Thus I can allow the UI to dig however deep the user wishes."),n.a.createElement("h3",{id:"localization"},"Localization"),n.a.createElement("p",null,"Probably you've already gleaned that the app is bilingual. I manage localization through a simple literal system. For example, here's the text content to go with the above operation:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-coffeescript"},"zeroExpPowerToOne:",n.a.createElement("br",null),"    id: ",n.a.createElement("span",{className:"hljs-number"},"2"),n.a.createElement("br",null),"    sv:",n.a.createElement("br",null),"        name: ",n.a.createElement("span",{className:"hljs-string"},'"omvandla potens till 1"'),n.a.createElement("br",null),"        explanation: ",n.a.createElement("span",{className:"hljs-string"},'"Exponenten ber\xe4ttar hur m\xe5nga g\xe5nger vi multiplicerar basen med sig sj\xe4lv. Men har vi 0 faktorer s\xe5 \xe5terst\xe5r bara det neutrala elementet f\xf6r multiplikation, n\xe4mligen 1."'),n.a.createElement("br",null),"        targets: ",n.a.createElement("span",{className:"hljs-string"},'"en potens med exponent 0 och bas skiljd fr\xe5n 0"'),n.a.createElement("br",null),"        returns: ",n.a.createElement("span",{className:"hljs-string"},'"det naturliga talet 1"'),n.a.createElement("br",null),"        effect: ",n.a.createElement("span",{className:"hljs-string"},'"Detta \xe4r en f\xf6renklande regel, eftersom den kollapsar potensen till talet 1"'),n.a.createElement("br",null),"        steps:",n.a.createElement("br",null),"            turnzeroexpto1minus1: ",n.a.createElement("span",{className:"hljs-string"},'"F\xf6rst delar vi upp exponenten 0 i en summa, f\xf6r att sedan kunna dela upp potensen."'),n.a.createElement("br",null),"            splitpow: ",n.a.createElement("span",{className:"hljs-string"},'"Vi delar upp potensen i tv\xe5 potensfaktorer. De nya potenserna f\xe5r exponenterna 1 och -1."'),n.a.createElement("br",null),"            dropexp1: ",n.a.createElement("span",{className:"hljs-string"},'"Exponenten 1 tar vi bort."'),n.a.createElement("br",null),"            movetodenom: ",n.a.createElement("span",{className:"hljs-string"},'"Den andra potensen flyttar vi ner i n\xe4mnaren, vilket g\xf6r att exponenten byter tecken, blir 1 och f\xf6rsvinner!"'),n.a.createElement("br",null),"            andcollapsefracto1: ",n.a.createElement("span",{className:"hljs-string"},'"Nu har vi ett br\xe5k med identisk t\xe4ljare och n\xe4mnare, vilket vi kollapsar till 1!"'),n.a.createElement("br",null),"    en:",n.a.createElement("br",null),"        name: ",n.a.createElement("span",{className:"hljs-string"},'"transform power to 1"'),n.a.createElement("br",null),"        explanation: ",n.a.createElement("span",{className:"hljs-string"},'"The exponent tells us how many times we multiply the base with itself. But if we have 0 factors we just get the neutral element of multiplication, namely 1."'),n.a.createElement("br",null),"        targets: ",n.a.createElement("span",{className:"hljs-string"},'"a power with exponent 0 and base not equal to 0"'),n.a.createElement("br",null),"        returns: ",n.a.createElement("span",{className:"hljs-string"},'"the natural number 1"'),n.a.createElement("br",null),"        effect: ",n.a.createElement("span",{className:"hljs-string"},'"This is a simplifying rule, since it collapses the power to the number 1"'),n.a.createElement("br",null),"        steps:",n.a.createElement("br",null),"            turnzeroexpto1minus1: ",n.a.createElement("span",{className:"hljs-string"},'"First we split the exponent 0 into a sum, which will enable us to split the power."'),n.a.createElement("br",null),"            splitpow: ",n.a.createElement("span",{className:"hljs-string"},'"Now we split the power into two power factors. The new powers get the exponents 1 and -1."'),n.a.createElement("br",null),"            dropexp1: ",n.a.createElement("span",{className:"hljs-string"},'"The exponent 1 can be removed."'),n.a.createElement("br",null),"            movetodenom: ",n.a.createElement("span",{className:"hljs-string"},'"The other power we move into the denominator, which makes the exponent become 1 and disappear."'),n.a.createElement("br",null),"            andcollapsefracto1: ",n.a.createElement("span",{className:"hljs-string"},'"Now we have a fraction with identical numerator and denominator, which we can collapse to 1!"'))),n.a.createElement("p",null,"Note how the ",n.a.createElement("code",null,"steps")," keys correspond to the strings used in the ",n.a.createElement("code",null,"zeroExpPowerToOne")," source."),n.a.createElement("p",null,"Initially I was worried about keeping such large objects in memory - the one defined in this file, containing all operation descriptions and substep explanations, is over half a megabyte! But as it turned out, this proved to work rather smoothly even on lower end devices."),n.a.createElement("h3",{id:"regular-expressions-ftw"},"Regular expressions ftw"),n.a.createElement("p",null,"As you can see in the screenshot up top, some terms inside explanations are clickable. Algebra Explorer has an integrated glossary - click the term to navigate to the definition for that term. This is done dynamically by defining a ",n.a.createElement("code",null,"matcher")," for each glossary entry. Here's the definition for the word ",n.a.createElement("code",null,"extract"),":"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-coffeescript"},"extract:",n.a.createElement("br",null),"    matcher:",n.a.createElement("br",null),"        en: ",n.a.createElement("span",{className:"hljs-string"},'"extracte?d?i?n?g?"'),n.a.createElement("br",null),"        sv: ",n.a.createElement("span",{className:"hljs-string"},'"br[y\xf6]ta?e?r?s?( vi)? ut"'),n.a.createElement("br",null),"    headline:",n.a.createElement("br",null),"        en: ",n.a.createElement("span",{className:"hljs-string"},'"extract"'),n.a.createElement("br",null),"        sv: ",n.a.createElement("span",{className:"hljs-string"},'"bryta ut"'),n.a.createElement("br",null),"    description:",n.a.createElement("br",null),"        en: ",n.a.createElement("span",{className:"hljs-string"},'"When we factorise an expression because we are interested in one of the resulting factors, we say that we extracted that factor."'),n.a.createElement("br",null),"        sv: ",n.a.createElement("span",{className:"hljs-string"},"\"Om vi faktoriserar ett uttryck f\xf6r att vi \xe4r intresserade av en av de resulterande faktorerna, s\xe5 s\xe4ger vi att vi har brytit ut (eller 'extraherat') den faktorn.\""))),n.a.createElement("p",null,"This saved me from manually having to write the links, which would have made authoring the texts a real drag."),n.a.createElement("p",null,"At first this didn't work too well - sometimes there was a wording I hadn't anticipated and the word wouldn't be clickable, and other times words would be made clickable when they shouldn't be as they meant something entirely different in that context. This got better over time as I got better at phrasing dexterous but still picky regexes.",n.a.createElement("br",null),n.a.createElement("br",null)),n.a.createElement("p",null,"I also made a special ",n.a.createElement("code",null,"MAKESAFE")," matcher which wraps all matched content in a span, to prevent it from later being made clickable. This matcher used to be very complicated as it had to cater for lots of false positives, but now this is all that remains:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-coffeescript"},"MAKESAFE:",n.a.createElement("br",null),"    matcher:",n.a.createElement("br",null),"        en: ",n.a.createElement("span",{className:"hljs-string"},'"introduced to|[01]\\\\.[0-9]+|number of times|any number of|the number of|a number of|1\\\\/|E?e?ven (though|if the)|introduced logic"'),n.a.createElement("br",null),"        sv: ",n.a.createElement("span",{className:"hljs-string"},'"vardagligt tal|introduceras till|[01][\\\\,\\\\.][0-9]+|1\\\\/|introducerade logik"'))),n.a.createElement("h3",{id:"unit-testing-with-vows"},"Unit testing with Vows"),n.a.createElement("p",null,"For unit testing my choice fell on ",n.a.createElement("a",{href:"http://vowsjs.org/"},"Vows"),', which turned out to be a very good fit. The main advantage for me was that the test definitions in vows are object literals, which makes it easy to write helper functions (they call them "macros") to clean up your tests.'),n.a.createElement("p",null,"Here is what it can look like, using the ",n.a.createElement("code",null,"mergeSameBaseFacs")," operation as an example:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-coffeescript"},"tests.addBatch ",n.a.createElement("span",{className:"hljs-string"},'"the mergeSameBaseFacs op"'),":",n.a.createElement("br",null),"    topic: ",n.a.createElement("span",{className:"hljs-function"},"->")," tools.mergeSameBaseFacs",n.a.createElement("br",null),"    hasInfo: info",n.a.createElement("br",null),"        name: ",n.a.createElement("span",{className:"hljs-string"},'"mergeSameBaseFacs"'),n.a.createElement("br",null),"        effect: ",n.a.createElement("span",{className:"hljs-string"},'"simplifying"'),n.a.createElement("br",null),"        example: (str:",n.a.createElement("span",{className:"hljs-string"},'"x*y*x2"'),",selection:[[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"2"),"]])",n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-string"},'"the target def says product"'),": targetIs ",n.a.createElement("span",{className:"hljs-string"},'"product"'),n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-string"},'"the selection def"'),": selection",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"has min 2"'),": min ",n.a.createElement("span",{className:"hljs-number"},"2"),n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-string"},'"the auto func"'),": auto",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"for no same base fac prod"'),": test",n.a.createElement("br",null),"            withTarget: (Product x, z, Power y,two)",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get err"'),": isError ",n.a.createElement("span",{className:"hljs-string"},'"musthavesamebasefacs"'),n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"for same base fac prod"'),": test",n.a.createElement("br",null),"            withTarget: (Product x, z, two, Power x,two)",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get correct obj"'),": isObj",n.a.createElement("br",null),"                selection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"3"),"]]",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"when neg hiding same"'),": test",n.a.createElement("br",null),"            withTarget: (Product x, z, two, Neg Power x,two)",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get correct obj"'),": isObj",n.a.createElement("br",null),"                selection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"3"),"]]",n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-string"},'"the perform func"'),": perform",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"when leftover facs"'),": test",n.a.createElement("br",null),"            withTarget: (Product x, z, (Power x,three), Power x,two)",n.a.createElement("br",null),"            withSelection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"2"),",",n.a.createElement("span",{className:"hljs-number"},"3"),"]]",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get right answer"'),": resultIs (Product (Power x, Num ",n.a.createElement("span",{className:"hljs-number"},"6"),"), z)",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"sels are beforemarked"'),": beforemarks [[",n.a.createElement("span",{className:"hljs-number"},"0"),"],[",n.a.createElement("span",{className:"hljs-number"},"2"),"],[",n.a.createElement("span",{className:"hljs-number"},"3"),"]]",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"pow is aftermarked"'),": aftermarks [[",n.a.createElement("span",{className:"hljs-number"},"0"),"]]",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"when no leftovers"'),": test",n.a.createElement("br",null),"            withTarget: (Product x, (Power x,three), Power x,two)",n.a.createElement("br",null),"            withSelection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"1"),",",n.a.createElement("span",{className:"hljs-number"},"2"),"]]",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get right answer"'),": (resultIs Power x, Num ",n.a.createElement("span",{className:"hljs-number"},"6"),")",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"and no aftermarks"'),": aftermarks ",n.a.createElement("span",{className:"hljs-literal"},"undefined"),n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"when non-numeric"'),": test",n.a.createElement("br",null),"            withTarget: (Product x, Power x, y)",n.a.createElement("br",null),"            withSelection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"1"),"]]",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get right answer"'),": (resultIs Power x, Sum one, y)",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"when multinonnumeric"'),": test",n.a.createElement("br",null),"            withTarget: (Product (Power two, x), (Power two, y), Power two, z)",n.a.createElement("br",null),"            withSelection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"1"),",",n.a.createElement("span",{className:"hljs-number"},"2"),"]]",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get right ans"'),": (resultIs Power two, Sum x,y,z)",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"when partly numeric"'),": test",n.a.createElement("br",null),"            withTarget: (Product (Power two, three), (Power two, y), two)",n.a.createElement("br",null),"            withSelection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"1"),",",n.a.createElement("span",{className:"hljs-number"},"2"),"]]",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get right ans"'),": (resultIs Power two,Sum (Num ",n.a.createElement("span",{className:"hljs-number"},"4"),"), y)",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-string"},'"when one negation"'),": test",n.a.createElement("br",null),"            withTarget: (Product (Power two, three), (Neg Power two, y), two)",n.a.createElement("br",null),"            withSelection: [[",n.a.createElement("span",{className:"hljs-number"},"0"),",",n.a.createElement("span",{className:"hljs-number"},"1"),",",n.a.createElement("span",{className:"hljs-number"},"2"),"]]",n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-string"},'"we get right ans"'),": (resultIs Neg Power two,Sum (Num ",n.a.createElement("span",{className:"hljs-number"},"4"),"), y)")),n.a.createElement("p",null,"Combined with the added readability of CoffeeScript, this really makes for some sleek tests!"),n.a.createElement("h3",{id:"wrapping-up"},"Wrapping up"),n.a.createElement("p",null,"When I started, part of my motivation was to show that it was possible to build this kind of thing with JavaScript. That's not a point that needs to be made anymore, and there are already several other CAS implementations built on the web stack."),n.a.createElement("p",null,"Still, I am rather proud of my creation! Sure, it contains many rough edges, the UI isn't that intuitive, and many times the fact that this is a one man show shines through. But for those who get over the initial threshold it seems the app can really help them grokk algebra. We're starting now to roll it out for the maths students in the Swedish prisons, and I hope teachers outside the walls will catch on too. Time will tell."),n.a.createElement("p",null,"And also the code is really pretty. :)"),n.a.createElement("p",null,"Anyhow, if you have an interest then please do give ",n.a.createElement("a",{href:"http://www.algebraexplorer.com"},"Algebra Explorer")," a spin! Any and all feedback much appreciated!"),n.a.createElement("script",{type:"text/javascript",dangerouslySetInnerHTML:{__html:'\n  document.querySelector(".launchbutton").addEventListener("click",function(e){\n    var win = window.open("https://krawaller.github.io/math3/www/index.html?demo=1&seed=284716495&source=fbtab&language=en",\'targetWindow\',\'toolbar=0,location=0,status=0,menubar=0,scrollbars=1,resizable=1,width=320,height=568\');\n    win = win || {};\n    win.height = 568;\n    win.width = 320;\n    e.preventDefault();\n  });\n'}})),n.a.createElement("hr",null))}},PGMW:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/algebra-explorer-a-symbolic-calculator-web-app",function(){var e=t("3kEV");return{page:e.default||e}}])}},[["PGMW",1,0]]]);