(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{lmVM:function(e,a,t){"use strict";t.r(a);var l=t("q1tI"),n=t.n(l),s=t("JRaF"),r=t("YFqc"),c=t.n(r),m={url:"a-look-at-the-react-redux-lib",id:"reactredux",type:"post",title:"A look at the React-Redux lib",date:"2016-04-06",tags:["react","redux"],author:"david",excerpt:"Exploring the official bindings between React and Redux, and getting a better grip on the marriage in the process",draft:!1,folder:"/Users/davidwaller/gitreps/mine/blog2/sources/2016-04-06_reactredux",hasStaticContent:!0,headlines:[{level:3,text:"The premise",id:"the-premise"},{level:3,text:"The Redux parts",id:"the-redux-parts"},{level:3,text:"React components",id:"react-components"},{level:3,text:"Our mission",id:"our-mission"},{level:3,text:"The vanilla version",id:"the-vanilla-version"},{level:3,text:"The React-Redux API",id:"the-reactredux-api"},{level:3,text:"React-Redux integration",id:"reactredux-integration"},{level:3,text:"Controversy",id:"controversy"},{level:3,text:"Wrapping up",id:"wrapping-up"}]};a.default=function(){return n.a.createElement(s.a,{kind:"post",data:m,title:"A look at the React-Redux lib",summary:"Exploring the official bindings between React and Redux, and getting a better grip on the marriage in the process",headlines:[{level:3,text:"The premise",id:"the-premise"},{level:3,text:"The Redux parts",id:"the-redux-parts"},{level:3,text:"React components",id:"react-components"},{level:3,text:"Our mission",id:"our-mission"},{level:3,text:"The vanilla version",id:"the-vanilla-version"},{level:3,text:"The React-Redux API",id:"the-reactredux-api"},{level:3,text:"React-Redux integration",id:"reactredux-integration"},{level:3,text:"Controversy",id:"controversy"},{level:3,text:"Wrapping up",id:"wrapping-up"}],tags:["react","redux"]},n.a.createElement("div",{className:"post","data-postid":"reactredux"},n.a.createElement("h3",{id:"the-premise"},"The premise"),n.a.createElement("p",null,"Let's take a closer look at ",n.a.createElement("a",{href:"https://github.com/reactjs/react-redux"},"React-Redux"),", Dan Abramov's official helper library for ",n.a.createElement("strong",null,"combining React and Redux"),". What does this marriage actually entail?"),n.a.createElement("p",null,"In order to find out, we're going to build a super simple app that uses both React and Redux. We'll make one version where we glue the parts together ourselves, and then one where we let React-Redux act as bridge. "),n.a.createElement("p",null,"Here's the super-complicated app we're going to build:"),n.a.createElement("iframe",{src:"/static/posts/a-look-at-the-react-redux-lib/applets/fromcourse/demos/usinglibiframe.html",height:"200px",width:"100%"}),n.a.createElement("h3",{id:"the-redux-parts"},"The Redux parts"),n.a.createElement("p",null,"We begin by creating the Redux plumbing needed to support this app! We'll follow the same pattern as discussed in the ",n.a.createElement(c.a,{href:"/posts/a-redux-app-tutorial",prefetch:!0},n.a.createElement("a",null,"Redux example walkthrough post")),"."),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("p",null,"Our ",n.a.createElement("strong",null,"app state")," will be an ",n.a.createElement("strong",null,"array of strings"),".")),n.a.createElement("li",null,n.a.createElement("p",null,"Let's make our ",n.a.createElement("strong",null,"initial state")," prepopulated with a quote to set the tone:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," initial = [",n.a.createElement("span",{className:"hljs-string"},"'Carpe diem'"),"];"))),n.a.createElement("li",null,n.a.createElement("p",null,"The single ",n.a.createElement("strong",null,"action")," that can happen, ",n.a.createElement("strong",null,"adding a quote"),", could look like this:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"type"),": ",n.a.createElement("span",{className:"hljs-string"},"'ADD'"),",",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"text"),": ",n.a.createElement("span",{className:"hljs-string"},"'Do unto others etc etc'"),n.a.createElement("br",null),"}"))),n.a.createElement("li",null,n.a.createElement("p",null,"Here's the ",n.a.createElement("strong",null,"reducer")," to handle this setup:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," reducer = ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"state,action"),")"),"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"switch"),"(action.type){",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"case")," ",n.a.createElement("span",{className:"hljs-string"},"'ADD'"),": ",n.a.createElement("span",{className:"hljs-keyword"},"return")," state.concat(action.text);",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"default"),": ",n.a.createElement("span",{className:"hljs-keyword"},"return")," state;",n.a.createElement("br",null),"   }",n.a.createElement("br",null),"};"))),n.a.createElement("li",null,n.a.createElement("p",null,"We instantiate the ",n.a.createElement("strong",null,"store")," as per usual:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," store = Redux.createStore(reducer,initial);"))),n.a.createElement("li",null,n.a.createElement("p",null,"We only need one ",n.a.createElement("strong",null,"action creator")," to interact with our store, but let's put it in an object anyway:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," actionCreators = {",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"addQuote"),": ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"text"),")"),"{",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"return")," {",n.a.createElement("span",{className:"hljs-attr"},"type"),":",n.a.createElement("span",{className:"hljs-string"},"'ADD'"),",",n.a.createElement("span",{className:"hljs-attr"},"text"),":text};",n.a.createElement("br",null),"   }",n.a.createElement("br",null),"};")))),n.a.createElement("p",null,"Now all the ",n.a.createElement("strong",null,"Redux parts")," needed to support our functionality are in place!"),n.a.createElement("h3",{id:"react-components"},"React components"),n.a.createElement("p",null,"The app can be broken down into ",n.a.createElement("strong",null,"two components"),":"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("code",null,"QuoteList")," to ",n.a.createElement("strong",null,"display the quotes")),n.a.createElement("li",null,n.a.createElement("code",null,"QuoteForm")," to hold the ",n.a.createElement("strong",null,"form for new quotes"))),n.a.createElement("p",null,"We farmed out the creation of these components to some interns. Because they didn't know what data handling solution the app would use, they've made the components ",n.a.createElement("strong",null,"portable"),". This of course is ",n.a.createElement("strong",null,"good practice")," in any scenario, as it makes the code ",n.a.createElement("strong",null,"easier to test")," and ",n.a.createElement("strong",null,"less coupled"),"."),n.a.createElement("p",null,"Let's check out what they gave us!"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("p",null,"First we have ",n.a.createElement("code",null,"QuoteList"),". It ",n.a.createElement("strong",null,"expects to receive an array of quotes")," in the ",n.a.createElement("code",null,"quotes")," property:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," QuoteList = ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"props"),")"),"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"var")," list = props.quotes.map(",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"q,n"),")"),"{",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"return")," ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"li")," ",n.a.createElement("span",{className:"hljs-attr"},"key"),"=",n.a.createElement("span",{className:"hljs-string"},"{n}"),">"),"{q}",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"li"),">")),";",n.a.createElement("br",null),"   });",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"return")," (",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"div")," ",n.a.createElement("span",{className:"hljs-attr"},"className"),"=",n.a.createElement("span",{className:"hljs-string"},'"quoteslist"'),">"),n.a.createElement("br",null),"           ",n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"h3"),">"),"Words of Wisdom",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"h3"),">"),n.a.createElement("br",null),"           ",n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"ul"),">"),"{list}",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"ul"),">"),n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"div"),">")),n.a.createElement("br",null),"   );",n.a.createElement("br",null),"};"))),n.a.createElement("li",null,n.a.createElement("p",null,"And then we have ",n.a.createElement("code",null,"QuoteForm"),", which ",n.a.createElement("strong",null,"renders the form")," where the user enters a new quote. This components ",n.a.createElement("strong",null,"expects to receive a callback")," in the ",n.a.createElement("code",null,"callback")," property which will be invoked with the text of the new quote when the user clicks the button."),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," QuoteForm = React.createClass({",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"submit"),": ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"e"),")"),"{",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"var")," field = ",n.a.createElement("span",{className:"hljs-built_in"},"this"),".refs.field;",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-built_in"},"this"),".props.callback(field.value);",n.a.createElement("br",null),"       field.value = ",n.a.createElement("span",{className:"hljs-string"},"''"),";",n.a.createElement("br",null),"       e.preventDefault();",n.a.createElement("br",null),"   },",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"render"),": ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"}),")"),"{",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"return")," (",n.a.createElement("br",null),"           ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"form")," ",n.a.createElement("span",{className:"hljs-attr"},"onSubmit"),"=",n.a.createElement("span",{className:"hljs-string"},"{this.submit}"),">"),n.a.createElement("br",null),"               ",n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"input")," ",n.a.createElement("span",{className:"hljs-attr"},"ref"),"=",n.a.createElement("span",{className:"hljs-string"},"'field'")," />"),n.a.createElement("br",null),"               ",n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"button")," ",n.a.createElement("span",{className:"hljs-attr"},"type"),"=",n.a.createElement("span",{className:"hljs-string"},"'submit'"),">"),"Add",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"button"),">"),n.a.createElement("br",null),"           ",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"form"),">")),n.a.createElement("br",null),"       );",n.a.createElement("br",null),"   }",n.a.createElement("br",null),"});")),n.a.createElement("p",null,"Note that they had to use the ",n.a.createElement("strong",null,"createClass")," syntax for the ",n.a.createElement("code",null,"QuoteForm")," component. Otherwise they couldn't use ",n.a.createElement("code",null,"ref"),"s, which they need in order to ",n.a.createElement("strong",null,"collect the value from the input tag"),"."))),n.a.createElement("h3",{id:"our-mission"},"Our mission"),n.a.createElement("p",null,"Obviously, we are far from done. The Redux code is complete and the React components are in place, but they're ",n.a.createElement("strong",null,"not connected to each other"),"."),n.a.createElement("p",null,"Both React components have a clear interface; they expect to be given certain props. A common pattern is to wrap them in ",n.a.createElement("strong",null,"container components")," which are hooked into the data layer and supplies these props. Then our ",n.a.createElement("strong",null,"final app")," could be:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," App = ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"props"),")"),"{",n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-keyword"},"return")," (",n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"div"),">"),n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"QuoteListContainer")," />"),n.a.createElement("br",null),"            ",n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"QuoteFormContainer")," />"),n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"div"),">")),n.a.createElement("br",null),"    );",n.a.createElement("br",null),"};")),n.a.createElement("p",null,"Creating these container components is exactly what our mission now entails!"),n.a.createElement("h3",{id:"the-vanilla-version"},"The vanilla version"),n.a.createElement("p",null,"As promised, before we look at ",n.a.createElement("code",null,"React-Redux"),", we'll have a go at implementing these containers ourselves, vanilla style."),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("p",null,"First we have ",n.a.createElement("code",null,"QuoteList"),", which expects to be given an ",n.a.createElement("strong",null,"array of quotes")," as a prop. Since we must also ",n.a.createElement("strong",null,"update when the data changes"),", we need to create a component that ",n.a.createElement("strong",null,"has Redux data as state"),". Said and done!"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," QuoteListContainer = React.createClass({",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"getInitialState"),": ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"}),")"),"{",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"return")," {",n.a.createElement("span",{className:"hljs-attr"},"quotes"),":[]};",n.a.createElement("br",null),"   },",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"componentDidMount"),": ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"}),")"),"{",n.a.createElement("br",null),"       store.subscribe(",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"}),")"),"{",n.a.createElement("br",null),"           ",n.a.createElement("span",{className:"hljs-built_in"},"this"),".setState({",n.a.createElement("span",{className:"hljs-attr"},"quotes"),": store.getState()});",n.a.createElement("br",null),"       }.bind(",n.a.createElement("span",{className:"hljs-built_in"},"this"),"));",n.a.createElement("br",null),"   },",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-attr"},"render"),": ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"}),")"),"{",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-keyword"},"return")," ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"QuoteList")," ",n.a.createElement("span",{className:"hljs-attr"},"quotes"),"=",n.a.createElement("span",{className:"hljs-string"},"{this.state.quotes}")," />")),";",n.a.createElement("br",null),"   }",n.a.createElement("br",null),"});")),n.a.createElement("p",null,"In the ",n.a.createElement("code",null,"componentDidMount")," lifecycle hook we ",n.a.createElement("strong",null,"initiate a store subscription"),", which will ",n.a.createElement("strong",null,"update the component state")," on every change.")),n.a.createElement("li",null,n.a.createElement("p",null,"Moving on to ",n.a.createElement("code",null,"QuoteForm")," - that component needs to be given a ",n.a.createElement("strong",null,"callback")," which it ",n.a.createElement("strong",null,"invokes with new quotes"),". This should of course be ",n.a.createElement("strong",null,"passed along to the store"),"."),n.a.createElement("p",null,"First we create ",n.a.createElement("strong",null,"bound action creators")," for our component to use:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," boundActionCreators = Redux.bindActionCreators(",n.a.createElement("br",null),"   actionCreators,",n.a.createElement("br",null),"   store.dispatch",n.a.createElement("br",null),");")),n.a.createElement("p",null,"This will ensure that whatever is returned from the action creators will be passed along to ",n.a.createElement("code",null,"store.dispatch"),"."),n.a.createElement("p",null,"We then make a container that simply passes in the bound action creator:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," QuoteFormContainer = ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"props"),")"),"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"return")," ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"QuoteForm")," ",n.a.createElement("span",{className:"hljs-attr"},"callback"),"=",n.a.createElement("span",{className:"hljs-string"},"{boundActionCreators.addQuote}/"),">")),";",n.a.createElement("br",null),"};")))),n.a.createElement("p",null,"We can now initialise our app as expected!"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},"ReactDOM.render(",n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"App"),"/>")),",",n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-built_in"},"document"),".getElementById(",n.a.createElement("span",{className:"hljs-string"},'"container"'),")",n.a.createElement("br",null),");",n.a.createElement("br",null),"store.dispatch({",n.a.createElement("span",{className:"hljs-attr"},"type"),":",n.a.createElement("span",{className:"hljs-string"},"'BOGUSEVENT'"),"}); ",n.a.createElement("span",{className:"hljs-comment"},"// triggers initial render"))),n.a.createElement("p",null,"Aaaand, we're done!"),n.a.createElement("p",null,"This vanilla solution ",n.a.createElement("strong",null,"works just fine"),". The only downside is that we had to ",n.a.createElement("strong",null,"access our store to create our containers"),";"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("code",null,"QuoteListContainer")," needed ",n.a.createElement("code",null,"store.subscribe")," and ",n.a.createElement("code",null,"store.getState")),n.a.createElement("li",null,n.a.createElement("code",null,"QuoteFormContainer")," needed ",n.a.createElement("code",null,"store.dispatch"),".")),n.a.createElement("p",null,"A stand-alone vanilla version with full source displayed can be found ",n.a.createElement("a",{href:"/static/posts/a-look-at-the-react-redux-lib/applets/fromcourse/demos/vanilla.html"},"here"),"."),n.a.createElement("h3",{id:"the-react-redux-api"},"The React-Redux API"),n.a.createElement("p",null,"Before we create containers with ",n.a.createElement("code",null,"React-Redux"),", let's explore the API!"),n.a.createElement("p",null,"The primary workhorse of ",n.a.createElement("code",null,"React-Redux")," is the ",n.a.createElement("code",null,".connect")," method which ",n.a.createElement("strong",null,"generates container components"),". Sounds like exactly what we need! It has the following syntax:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},"ReactRedux.connect(",n.a.createElement("br",null),"    mapStateToProps,     ",n.a.createElement("span",{className:"hljs-comment"},"// connecting to store state"),n.a.createElement("br",null),"    mapDispatchToProps,  ",n.a.createElement("span",{className:"hljs-comment"},"// connecting to store dispatch"),n.a.createElement("br",null),"    mergeProps           ",n.a.createElement("span",{className:"hljs-comment"},"// baking all props together"),n.a.createElement("br",null),")(ComponentToWrap)       ",n.a.createElement("span",{className:"hljs-comment"},"// the component to be wrapped"))),n.a.createElement("p",null,"Notice the slightly weird ",n.a.createElement("strong",null,"double invocation")," syntax - the call to connect returns a function which is then immediately called with a component. It could just as well have been created as one single method with 4 arguments, so don't lose sleep over this."),n.a.createElement("p",null,"We'll now ",n.a.createElement("strong",null,"look at the 3 parameters to ",n.a.createElement("code",null,"connect"))," one at a time:"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("p",null,n.a.createElement("code",null,"mapStateToProps")," is a ",n.a.createElement("strong",null,"function"),". It will be ",n.a.createElement("strong",null,"invoked with the store state"),", and what you ",n.a.createElement("strong",null,"return")," from the method will become ",n.a.createElement("strong",null,"additional props on the component"),"."),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function")," ",n.a.createElement("span",{className:"hljs-title"},"mapStateToProps"),"(",n.a.createElement("span",{className:"hljs-params"},"appstate"),")"),"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"return")," {",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-attr"},"numberOfPosts"),": appstate.posts.length",n.a.createElement("br",null),"   };",n.a.createElement("br",null),"}"))),n.a.createElement("li",null,n.a.createElement("p",null,n.a.createElement("code",null,"mapDispatchToProps")," can be an object or a function. If it is an ",n.a.createElement("strong",null,"object")," it is assumed to ",n.a.createElement("strong",null,"contain action creators"),". It will be made ",n.a.createElement("strong",null,"available as props on the component"),", only now all methods ",n.a.createElement("strong",null,"automatically pipe what they're returning to the store dispatch")," much like after a ",n.a.createElement("code",null,"Redux.bindActionCreators")," call."),n.a.createElement("p",null,"If ",n.a.createElement("code",null,"mapDispatchToProps")," is a ",n.a.createElement("strong",null,"function")," then it'll be ",n.a.createElement("strong",null,"invoked with the store dispatch"),", and you must manually return props and ",n.a.createElement("strong",null,"add dispatch calls yourself"),"."),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function")," ",n.a.createElement("span",{className:"hljs-title"},"mapDispatchToProps"),"(",n.a.createElement("span",{className:"hljs-params"},"dispatch"),")"),"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"return")," {",n.a.createElement("br",null),"       ",n.a.createElement("span",{className:"hljs-attr"},"addPost"),": ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"text"),")"),"{",n.a.createElement("br",null),"           ",n.a.createElement("span",{className:"hljs-keyword"},"var")," action = actionCreators.addPost(text);",n.a.createElement("br",null),"           dispatch(action);",n.a.createElement("br",null),"       }",n.a.createElement("br",null),"   }",n.a.createElement("br",null),"}"))),n.a.createElement("li",null,n.a.createElement("p",null,"Finally the ",n.a.createElement("code",null,"mergeProps")," function handles the fact that a connected component ",n.a.createElement("strong",null,"receives props from 3 sources")," which must somehow be ",n.a.createElement("strong",null,"baked together"),":"),n.a.createElement("p",null,n.a.createElement("img",{src:"/static/posts/a-look-at-the-react-redux-lib/img/rr-propsources.png",alt:"bake props"})),n.a.createElement("p",null,"If ",n.a.createElement("code",null,"mergeProps")," isn't supplied then ",n.a.createElement("code",null,"ReactRedux")," will do this ",n.a.createElement("strong",null,"by default"),":"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},"props = ",n.a.createElement("span",{className:"hljs-built_in"},"Object"),".assign({}, parentProps, stateProps, dispatchProps)")),n.a.createElement("p",null,"For the majority of cases this is fine. But if you want control, ",n.a.createElement("strong",null,"provide ",n.a.createElement("code",null,"mergeProps"))," and do your own baking. It is ",n.a.createElement("strong",null,"called with all three sources")," like this:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function")," ",n.a.createElement("span",{className:"hljs-title"},"mergeProps"),"(",n.a.createElement("span",{className:"hljs-params"},"fromState,fromDispatch,fromParent"),")"),"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-comment"},"// do your own baking and return it"),n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"return")," myBakedProps;",n.a.createElement("br",null),"}")))),n.a.createElement("p",null,"Now we know what we need to know in order to put ",n.a.createElement("code",null,"ReactRedux.connect")," to work! There are several other nuances to the API that we didn't look at here, so check the ",n.a.createElement("a",{href:"https://github.com/reactjs/react-redux"},"official homepage")," for those if you're interested."),n.a.createElement("h3",{id:"react-redux-integration"},"React-Redux integration"),n.a.createElement("p",null,"Ok, let's now remake the integration with the ",n.a.createElement("code",null,"React-Redux")," lib instead! Here's how the two containers are created:"),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("p",null,"We start with making the ",n.a.createElement("strong",null,n.a.createElement("code",null,"QuoteListContainer")),". Remember, ",n.a.createElement("code",null,"QuoteList")," expected the ",n.a.createElement("strong",null,"array of quotes as a props"),", which must also be ",n.a.createElement("strong",null,"kept live")," as the data updates. Thus we'll need to use the ",n.a.createElement("code",null,"mapStateToProps")," function."),n.a.createElement("p",null,"We need to ",n.a.createElement("strong",null,"map")," the ",n.a.createElement("strong",null,"entire app state"),", which is the array of quotes, ",n.a.createElement("strong",null,"to the ",n.a.createElement("code",null,"quotes")," property"),":"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," mapStateToQuoteListProps = ",n.a.createElement("span",{className:"hljs-function"},n.a.createElement("span",{className:"hljs-keyword"},"function"),"(",n.a.createElement("span",{className:"hljs-params"},"appstate"),")"),"{",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-keyword"},"return")," { ",n.a.createElement("span",{className:"hljs-attr"},"quotes"),": appstate };",n.a.createElement("br",null),"};")),n.a.createElement("p",null,"Now we ",n.a.createElement("strong",null,"create the container")," using the ",n.a.createElement("code",null,".connect")," method:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," QuoteListContainer = ReactRedux.connect(",n.a.createElement("br",null),"   mapStateToQuoteListProps",n.a.createElement("br",null),")(QuoteList);")),n.a.createElement("p",null,"This ",n.a.createElement("code",null,"QuoteListContainer")," will ",n.a.createElement("strong",null,"act exactly like the vanilla version"),", including keeping the data updated."))),n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("p",null,"Now for ",n.a.createElement("code",null,"QuoteFormContainer"),". It doesn't need to map state, but it ",n.a.createElement("strong",null,"expects the ",n.a.createElement("code",null,"callback")," prop")," to be a method whose ",n.a.createElement("strong",null,"return value should be ",n.a.createElement("code",null,"dispatch"),"ed"),"."),n.a.createElement("p",null,"Thus it suffices to simply ",n.a.createElement("strong",null,"rename the ",n.a.createElement("code",null,"addQuote")," action creator"),' to "callback":'),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," QuoteFormContainer = ReactRedux.connect(",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-literal"},"null"),", ",n.a.createElement("span",{className:"hljs-comment"},"// don't need appstate"),n.a.createElement("br",null),"   {",n.a.createElement("span",{className:"hljs-attr"},"callback"),": actionCreators.addQuote}",n.a.createElement("br",null),")(QuoteForm);")),n.a.createElement("p",null,"If we had been ",n.a.createElement("strong",null,"allowed to edit")," the code of ",n.a.createElement("code",null,"QuoteForm")," to ",n.a.createElement("strong",null,"use ",n.a.createElement("code",null,"props.addQuote")," instead")," of ",n.a.createElement("code",null,"props.callback"),", then we could have ",n.a.createElement("strong",null,"passed in the actionCreators object")," directly:"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," QuoteFormContainer = ReactRedux.connect(",n.a.createElement("br",null),"   ",n.a.createElement("span",{className:"hljs-literal"},"null"),",",n.a.createElement("br",null),"   actionCreators",n.a.createElement("br",null),")(QuoteForm);")))),n.a.createElement("p",null,"There, now we have both container components in place!"),n.a.createElement("p",null,"But, hang on - there's ",n.a.createElement("strong",null,"no single reference to the store")," anywhere in our code. How does ",n.a.createElement("code",null,".connect")," ",n.a.createElement("strong",null,"actually connect")," our components to the store?"),n.a.createElement("p",null,"Here's the ",n.a.createElement("strong",null,"final piece")," of the pussle: we must ",n.a.createElement("strong",null,"wrap our entire app in a ",n.a.createElement("code",null,"Provider"))," component which is ",n.a.createElement("strong",null,"given a store reference"),":"),n.a.createElement("pre",null,n.a.createElement("code",{className:"hljs language-javascript"},n.a.createElement("span",{className:"hljs-keyword"},"var")," Provider = ReactRedux.Provider;",n.a.createElement("br",null),n.a.createElement("br",null),"ReactDOM.render(",n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"xml"},n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"Provider")," ",n.a.createElement("span",{className:"hljs-attr"},"store"),"=",n.a.createElement("span",{className:"hljs-string"},"{store}"),">"),n.a.createElement("br",null),"        ",n.a.createElement("span",{className:"hljs-tag"},"<",n.a.createElement("span",{className:"hljs-name"},"App"),"/>"),n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-tag"},"</",n.a.createElement("span",{className:"hljs-name"},"Provider"),">")),",",n.a.createElement("br",null),"    ",n.a.createElement("span",{className:"hljs-built_in"},"document"),".getElementById(",n.a.createElement("span",{className:"hljs-string"},'"container"'),")",n.a.createElement("br",null),");")),n.a.createElement("p",null,"The ",n.a.createElement("code",null,"Provider")," uses the ",n.a.createElement("a",{href:"https://facebook.github.io/react/docs/context.html"},"React context API")," to supply a store reference to the generated container components."),n.a.createElement("p",null,"This version of our app is published ",n.a.createElement("a",{href:"/static/posts/a-look-at-the-react-redux-lib/applets/fromcourse/demos/usinglib.html"},"here"),", again with the full source appended."),n.a.createElement("h3",{id:"controversy"},"Controversy"),n.a.createElement("p",null,'Since React Context is "an advanced an experimental feature" where "the API is likely to change", there\'s been ',n.a.createElement("a",{href:"http://stackoverflow.com/questions/36428355/react-with-redux-what-about-the-context-issue"},"some concern")," around the fact that React-Redux (and others) uses it. What if context goes away and React-Redux ceases to function, what will happen to my app which uses both?"),n.a.createElement("p",null,"As this post has hopefully shown -  ",n.a.createElement("strong",null,"absolutely nothing"),". React-Redux is a very small helper library that saves us from having to pass a store reference around and reduces our code by a few lines. But the hand-made containers are pretty decopupled too, and they're not that much of a hassle to create."),n.a.createElement("h3",{id:"wrapping-up"},"Wrapping up"),n.a.createElement("p",null,"Whether or not you decide to use React-Redux in your React and Redux app, I hope this post has helped you to better understand the bridging problem and the various solutions available!"),n.a.createElement("div",{className:"smallnote"},"PS: Shameless plug time again! This post is an (adapted) excerpt from a 2-day React+Redux training course that I provide through my employer Edument. So if you're in Scandinavia and hungry for more, [check it out](http://edument.se/en/training/webdevelopment/react-js)!")),n.a.createElement("hr",null))}},zNcY:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/a-look-at-the-react-redux-lib",function(){var e=t("lmVM");return{page:e.default||e}}])}},[["zNcY",1,0]]]);